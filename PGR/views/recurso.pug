extends header
block content
    link(rel='stylesheet' href='/stylesheets/slideshow.css')
    link(rel='stylesheet', href='/stylesheets/profile.css') 
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous")
    .w3-h1 <i class="fas fa-file-archive"></i> #{data.titulo}
    hr
    br
    .container
        .main-body
            // /Breadcrumb
            .row.gutters-sm
                .col-md-4.mb-3
                    .card
                        .card-body
                            .d-flex.flex-column.align-items-center.text-center
                                if(f.tipo === "cartaz" && f.ext != "zip")
                                    .w3-row
                                            img(src='/fileStore/' + data.autor  + '/' + name_without_ext + '/data/' + conjunto_files[0] class="imgp" style="width:100%")
                                else if(f.ext == "pdf" || f.ext == "pptx")
                                    .w3-row
                                        div(class="w3-col s2")
                                            div(class="containerp")
                                                 a(href='/fileStore/' + data.autor  + '/' + name_without_ext + '/data/' + conjunto_files[0] target="_blank") Ver Ficheiro
                                else if(f.ext == "zip" && (f.tipo === "cartaz" || f.tipo === "teste" || f.tipo == "problema"))
                                    // Container for the image gallery
                                    .container
                                        each i in conjunto_files
                                            .mySlides
                                                img(src='/fileStore/' + data.autor + '/' + name_without_ext + '/data/' + i class="imgp" style="width:100%")
                                        br
                                        a.prev(onclick='plusSlides(-1)') ❮
                                        a.next(onclick='plusSlides(1)') ❯
                                .mt-3
                                    h4 #{data.subtitulo}
                                    p.text-secondary.mb-1 <i class="fas fa-user-graduate"></i> #{data.autor}                     
                    .card.mt-3
                        ul.list-group.list-group-flush
                            li.list-group-item.d-flex.justify-content-between.align-items-center.flex-wrap
                                h6.mb-0
                                a(href="/files/download/" + f.name) View
                .col-md-8
                    .card.mb-3
                        .card-body
                            .row
                                .col-sm-3
                                    h6.mb-0 <i class="fas fa-user-shield"></i> Descrição
                                .col-sm-9.text-secondary
                                    | #{data.descricao}
                            hr
                            .row
                                .col-sm-3
                                    h6.mb-0 <i class="fas fa-tag"></i> Tag's
                                .col-sm-9.text-secondary
                                    | #{data.hashtags}
                            hr
                            .row
                                .col-sm-3
                                    h6.mb-0 <i class="far fa-clock"></i> Data de criação
                                .col-sm-9.text-secondary
                                    | #{data.dataCriacao}
                            hr
                            .row
                                .col-sm-3
                                    h6.mb-0 <i class="fas fa-calendar-alt"></i> Data de upload
                                .col-sm-9.text-secondary
                                    | #{data.dataRegisto} 
                            hr
                            .row
                                .col-sm-3
                                    h6.mb-0 <i class="fas fa-star"></i> Pontuação
                                .col-sm-9.text-secondary
                                    | #{data.rating}
                    .row.gutters-sm
                        .col-sm-6.mb-3
                            .card.h-100
                                .card-body
                                    h6.align-items-center.mb-3(style="text-align: center") <i class="far fa-star"></i> Pontuação
                                        
                                    .rate
                                        input#star5(type='radio' name='rate' value='5')
                                        label(for='star5' title='text') 5 stars
                                        input#star4(type='radio' name='rate' value='4')
                                        label(for='star4' title='text') 4 stars  
                                        input#star3(type='radio' name='rate' value='3' onclick="ratee(this.value,'"+data._id+"','"+ data.autorID + "')")
                                        label(for='star3' title='text') 3 stars
                                        input#star2(type='radio' name='rate' value='2')
                                        label(for='star2' title='text') 2 stars
                                        input#star1(type='radio' name='rate' value='1')
                                        label(for='star1' title='text') 1 star 
                                  
        
                                  
                        .col-sm-6.mb-3
                            .card.h-100
                                .card-body
                                    <button class="btn"><i class="fa fa-download"></i> Download</button>

                    .row.gutters-sm
                        .col-md8
                            .card.mb-3
                                .card-body
                                    h3.align-items-center.mb-3 
                                    i(class="fas fa-comment")  
                                    |  Comentários
                                     
                                  
                                .w3-row.w3-margin
                                    input.w3-input.w3-border.w3-light-grey(type='text' name='desc' style='width: 30%' placeholder="Escreva aqui o seu comentário.")
                                .w3-row.w3-margin
                                    input.w3-btn.w3-teal.w3-border(type='submit' value='Submit')                                
    //----------------------------------------------------------------
    link(rel='stylesheet', href='/stylesheets/rating.css')
    script(src='/javascripts/rate.js')
    script(src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js")
    


 
    script. 
        function ratee(val,recursoID,userId) {
            var p = {
                recursoID: recursoID ,
                userID: userId,
                rating: val ,
                flag:0
            }
            console.log(p)
         
            axios.post('http://localhost:7777/recurso/voto?token=#{token}',p)
            .then(response => { 
            const addedUser = response.data;
            console.log(`POST: user is added`);// append to DOM
            })
            .catch(error => console.error(error));
        }
    script.
        $(document).ready(function(){
            // Check Radio-box
            $(".rating input:radio").attr("checked", false);

            $('.rating input').click(function () {
                $(".rating span").removeClass('checked');
                $(this).parent().addClass('checked');
            });

            $('input:radio').change(
              function(){
                var userRating = this.value;
                alert(userRating);
            });
        });
    script.
        var slideIndex = 1;
        showSlides(slideIndex);

        // Next/previous controls
        function plusSlides(n) {
            showSlides(slideIndex += n);
        }

        // Thumbnail image controls
        function currentSlide(n) {
            showSlides(slideIndex = n);
        }

        function showSlides(n) {
            var i;
            var slides = document.getElementsByClassName("mySlides");
            var dots = document.getElementsByClassName("demo");
            var captionText = document.getElementById("caption");
            if (n > slides.length) {slideIndex = 1}
            if (n < 1) {slideIndex = slides.length}
            for (i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            slides[slideIndex-1].style.display = "block";
            dots[slideIndex-1].className += " active";
            captionText.innerHTML = dots[slideIndex-1].alt;
        }